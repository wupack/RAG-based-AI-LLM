<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>知识库管理 - 文件上传</title>
    <link href="https://cdn.jsdelivr.net/npm/@mdi/font/css/materialdesignicons.min.css" rel="stylesheet">
    <link href="/static/css/upload.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="app-container">
        <!-- 左侧菜单栏 -->
        <div class="sidebar">
            <div class="sidebar-header">
                <i class="mdi mdi-robot-happy"></i>
                <h1>智能客服</h1>
            </div>
            <nav class="sidebar-menu">
                <div class="menu-section">
                    <div class="menu-item">
                        <i class="mdi mdi-database"></i>
                        <span>知识库选择</span>
                    </div>
                    <select id="vector-db-select" class="db-dropdown">
                        {% for db in vector_dbs %}
                        <option value="{{ db.name }}" {% if db.name == current_db %}selected{% endif %}>{{ db.name }}</option>
                        {% endfor %}
                    </select>
                    <div class="current-db-display">
                        <i class="mdi mdi-database"></i>
                        <span id="current-db-name">{{ current_db }}</span>
                    </div>
                </div>
                <a href="/upload" class="menu-item active">
                    <i class="mdi mdi-database-plus"></i>
                    <span>上传知识库</span>
                </a>
                <div class="menu-divider"></div>
                <a href="/" class="menu-item">
                    <i class="mdi mdi-forum"></i>
                    <span>对话界面</span>
                </a>
            </nav>
        </div>

        <!-- 主内容区 -->
        <div class="main-content">
            <div class="upload-container">
                <div class="upload-header">
                    <h1><i class="mdi mdi-database-import"></i> 生成知识库</h1>
                    <p>上传文档以构建智能问答知识库，支持PDF、Word、TXT等格式</p>
                </div>
                
                <div class="upload-card">
                    <div class="upload-area" id="dropArea">
                        <div class="upload-icon">
                            <i class="mdi mdi-cloud-upload"></i>
                        </div>
                        <div class="upload-text">
                            <h3>拖拽文件到此处</h3>
                            <p>或</p>
                        </div>
                        <button class="btn outline" id="selectFilesBtn">
                            <i class="mdi mdi-folder-open"></i>选择文件
                        </button>
                        <input type="file" id="fileInput" class="file-input" multiple 
                               accept=".txt,.pdf,.doc,.docx,.ppt,.pptx,.md,.markdown">
                    </div>
                    
                    <div class="form-group">
                        <label for="dbName">知识库名称</label>
                        <input type="text" id="dbName" placeholder="请输入知识库名称(唯一标识)" class="form-input">
                    </div>
                    
                    <div id="fileList" class="file-list-container">
                        <div class="file-list-header">
                            <span>已选文件</span>
                            <span id="fileCount">0个文件</span>
                        </div>
                        <div id="fileListContent" class="file-list-content"></div>
                    </div>
                    
                    <button class="btn primary" id="submitBtn">
                        <i class="mdi mdi-database-import"></i> 生成向量数据库
                    </button>
                    
                    <div id="status" class="status-container"></div>
                </div>
                
                <div class="existing-dbs">
                    <h3><i class="mdi mdi-database"></i> 已有知识库</h3>
                    <div class="db-grid">
                        {% for db in vector_dbs %}
                        <div class="db-card">
                            <i class="mdi mdi-database"></i>
                            <div class="db-info">
                                <span class="db-name">{{ db.name }}</span>
                                <span class="db-date">创建于: 2023-11-15</span>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="/static/js/upload.js"></script>
</body>
</html>